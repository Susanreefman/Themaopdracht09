---
title: "Report"
author: "H.S. Reefman"
date: "2-11-2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

```{r get dataset}
load("~/Documents/Themaopdracht09/tedsd_puf_2019.RData")

p <- "CASEID|AGE|EDUC|^EMPLOY|ALCDRUG|^SUB|^FREQ[1|2|3]|^ROUTE|^FRSTUSE|LOS|NOPRIOR|PSYPROB|DSMCRIT|REASON"

# get relevant data from data set
data <- df[, grep(pattern=p, colnames(df))]

```

The research topic of this project is the treatment episodes of patients. 
The dataset used in this project is from the Treatment Episode Data Set (TEDS), 
an American data system of annual discharges from substance use treatment facilities.
The used dataset is a TEDS-D dataset, which means it includes discharges from substance
use treatment facilities. TEDS-D contains records on admissions of people of 12-years and older,
and includes information of admission, substance use characteristics and discharges.
The dataset includes information from patients who where at the facility in 2019.
For this project some personal and substance use characteristics information are collected from the dataset. 
With this dataset a model can be made. In this project is researched whether the length of treatment can be predicted. 
The model is made by the following question: "Can the length of treatment be predicted 
based on the substance use, frequency of use and the age at first use by using machine learning?"
To answer this question information is collected from the dataset. The personal information
about the patients that is used is case id, age, education and employment status.
Other information is about substance characteristics, for example; substance use type, 
substance use at admission and discharge and route of administration.
The information about treatment episodes are also covered. This includes length
of stay in treatment, number of previous substance treatment episodes and reason of 
discharge. 


# Materials and Methods

https://github.com/Susanreefman/Themaopdracht09
Rstudio 
Weka Version 3.8.5

```{r pressure, echo=FALSE}
plot(pressure)
```

# Results

## EDA
The age of first use of the patients and the frequency of use is shown figure 2. 
The age of patients is divided in multiple groups, in which the first is 
12 years of younger and the last group is 29 years of older. 
The frequency for the secondary and tertiary substance is lower, 
most patients have one an addiction for one substance. 
For the frequency of substance use the primary substance is mostly use daily.
The frequency of use of secondary and tertiary substance are very similar,
the patients are almost evenly spread over the groups of frequency of use. 
The age of first use of patients seems normally distributed.
Figure 3 displays the number of patients and their substance of use. 
Not surprisingly is the red (tertiary substance) very high for the None of substance of use. 
Not all patients have multiple substances they are addicited to. However, 
there are a few patients that filled in that the have none as primary substance of use (blue). 
Alcohol, Heroin and Methamphetamine are the most substances that are used by patients. 
Figure 4 shows the usual route of administration of patients. 
Most patients use the oral route of administration of their substance use. 
Most patients that have a secondary substance use, use the smoking route of administration
of that substance. 
The boxplot in figure 5 shows the distribution of patients length of stay in treatment in days
versus the substance use type which they get treated for. The mean of length of stay 
when they indicated "none" as substance use type is 9 days. For alcohol and other drugs
the treatment is much longer. For alcohol as substance use type the average length of stay is 22 days.
For the patients with a substance use type of only drugs or alcohol and other drugs the average length
of stay is 28 days. The length of stay has a large difference in all substance use type groups. 


## Cleaning dataset

Because the dataset is very large and most of the data is not included in this project.
Only the characteristics of the use of patients is necessary, which include: Type of use (alcohol, drugs or both), the substance of use, the frequency of use, the route of inhalation and the age of first use. The length of stay is also necessary in this project. 
Because the dataset is this large, the patients which have information that is not available is removed from the dataset. This includes around 200.000 patients, the dataset still includes more than 1.5 million patients. 

## WEKA

The cleaned dataset is uploaded into the Weka Explorer.


## Machine learning



# Conclusion and Discussion

Overall, as can be seen in the figures (see Results), the data is widely spread.
The age of patients and the age of first use of patients seem normally distributed. 
The attributes of variables can be discussed. In some cases the attributes are vague
and can be wide interpreted. This is in the case of frequency of use, there 
are three groups in which the data is divided: No use in the past month, Some use 
and Daily use. As the first group is very clear, the second group is to vague. 
What is meant by some use? Also the third group, daily use, can be up for discussion;
how much is the substance used daily.


## Project proposal for minor
